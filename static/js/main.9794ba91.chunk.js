(this.webpackJsonpg2social=this.webpackJsonpg2social||[]).push([[0],{109:function(e,n,t){"use strict";t.r(n);var a=t(80),r=t.n(a),s=(t(94),function(e){e&&e instanceof Function&&t.e(3).then(t.bind(null,111)).then((function(n){var t=n.getCLS,a=n.getFID,r=n.getFCP,s=n.getLCP,c=n.getTTFB;t(e),a(e),r(e),s(e),c(e)}))}),c=t(2),o=t(3),i=t(27),l=t(13),d=(t(96),t(12)),u=t(18),m=t(81),b={user:null};if(localStorage.getItem("jwtToken")){var j=Object(m.a)(localStorage.getItem("jwtToken"));1e3*j.exp<Date.now()?localStorage.removeItem("jwtToken"):b.user=j}var O=Object(o.createContext)({user:null,login:function(e){},logout:function(){}});function p(e,n){switch(n.type){case"LOGIN":return Object(u.a)(Object(u.a)({},e),{},{user:n.payload});case"LOGOUT":return Object(u.a)(Object(u.a)({},e),{},{user:null});default:return e}}function f(e){var n=Object(o.useReducer)(p,b),t=Object(d.a)(n,2),a=t[0],r=t[1];return Object(c.jsx)(O.Provider,Object(u.a)({value:{user:a.user,login:function(e){localStorage.setItem("jwtToken",e.token),r({type:"LOGIN",payload:e})},logout:function(){localStorage.removeItem("jwtToken"),r({type:"LOGOUT"})}}},e))}var h=t(9),x=t(55),v=t.n(x),g=t(20),N=function(){var e=window.location.pathname.substring(9),n="/"===e||"posts"===e.substring(1).slice(0,5)?"home":e.substr(1).toLowerCase();return{underline:function(){document.querySelectorAll(".navbar-link").forEach((function(e){e.className="navbar-link"})),document.querySelector("#navbar-".concat(n)).classList.add("navbar-link-active")}}};function I(){var e=Object(g.a)(["\n    mutation likePost($postId: ID!){\n        likePost(postId: $postId){\n            id\n            body\n            createdAt\n            userId\n            username\n            commentCount\n            likeCount\n            comments {\n                id\n                userId\n                username\n                createdAt\n                body\n            }\n            likes {\n                id\n                userId\n                username\n                createdAt\n            }\n        }\n    }\n"]);return I=function(){return e},e}var C=Object(h.gql)(I()),y=function(e){var n=e.user,t=e.post,a=t.id,r=t.likes,s=t.likeCount,u=Object(l.f)(),m=Object(o.useState)(!1),b=Object(d.a)(m,2),j=b[0],O=b[1];Object(o.useEffect)((function(){n&&r.find((function(e){return e.userId===n.id}))?O(!0):O(!1)}),[n,r]);var p=Object(h.useMutation)(C,{update:function(e,n){},onError:function(e){},variables:{postId:a}}),f=Object(d.a)(p,1)[0],x=function(){f()};return n?j?Object(c.jsxs)("button",{className:"postcard-btn",onClick:function(){return x()},children:[Object(c.jsx)("i",{className:"fas fa-heart postcard-btn-icon postcard-btn-icon-active"}),Object(c.jsx)("p",{className:"postcard-btn-num",children:s})]}):Object(c.jsxs)("button",{className:"postcard-btn",onClick:function(){return x()},children:[Object(c.jsx)("i",{className:"far fa-heart postcard-btn-icon"}),Object(c.jsx)("p",{className:"postcard-btn-num",children:s})]}):Object(c.jsx)(i.b,{to:"/login",children:Object(c.jsxs)("button",{className:"postcard-btn",onClick:function(){return u.push("/"),void N().underline()},children:[Object(c.jsx)("i",{className:"far fa-heart postcard-btn-icon"}),Object(c.jsx)("p",{className:"postcard-btn-num",children:s})]})})},k=function(e){var n=e.setConfirmOpen,t=e.deletePostOrMutation;return Object(c.jsx)("div",{className:"confirm-delete",children:Object(c.jsx)("div",{className:"confirm-delete-overlay",children:Object(c.jsxs)("div",{className:"confirm-delete-box",children:[Object(c.jsx)("p",{className:"confirm-delete-box-p",children:"Are you sure?"}),Object(c.jsxs)("div",{className:"confirm-delete-box-btns",children:[Object(c.jsx)("button",{className:"confirm-delete-box-btn",onClick:function(){return n(!1)},children:Object(c.jsx)("i",{className:"fas fa-undo-alt"})}),Object(c.jsx)("button",{className:"confirm-delete-box-btn confirm-delete-box-btn-delete",onClick:function(){return t()},children:Object(c.jsx)("i",{className:"far fa-trash-alt"})})]})]})})})};function P(){var e=Object(g.a)(["\n    {\n        getPosts {\n            id\n            body\n            createdAt\n            userId\n            username\n            commentCount\n            likeCount\n            comments {\n                id\n                userId\n                username\n                createdAt\n                body\n            }\n            likes {\n                id\n                userId\n                username\n                createdAt\n            }\n        }\n    }\n"]);return P=function(){return e},e}var w=Object(h.gql)(P());function S(){var e=Object(g.a)(["\n    mutation deleteComment($postId: ID!, $commentId: ID!) {\n        deleteComment(postId: $postId, commentId: $commentId) {\n            id\n            comments {\n                id username createdAt body\n            }\n            commentCount\n        }\n    }\n"]);return S=function(){return e},e}function $(){var e=Object(g.a)(["\n    mutation deletePost($postId: ID!) {\n        deletePost(postId: $postId)\n    }\n"]);return $=function(){return e},e}var A=Object(h.gql)($()),L=Object(h.gql)(S()),q=function(e){var n=e.postId,t=e.deletePostCallback,a=e.isComment,r=e.commentId,s=Object(o.useState)(!1),i=Object(d.a)(s,2),l=i[0],m=i[1],b=r?L:A,j=Object(h.useMutation)(b,{update:function(e){if(!r){var a=e.readQuery({query:w}),s=Object(u.a)({},a);s.getPosts=s.getPosts.filter((function(e){return e.id!==n})),e.writeQuery({query:w,data:s})}t&&t()},variables:{postId:n,commentId:r}}),O=Object(d.a)(j,1)[0];return Object(c.jsxs)("div",{children:[Object(c.jsx)("button",{className:a?"postcard-btn-right postcard-btn-comment":"postcard-btn-right",onClick:function(){return m(!0)},children:Object(c.jsx)("i",{className:"fas fa-trash-alt"})}),l&&Object(c.jsx)(k,{setConfirmOpen:m,deletePostOrMutation:O})]})},E=function(e){var n=e.post,t=n.id,a=n.userId,r=n.username,s=n.createdAt,l=n.body,d=n.likeCount,u=n.commentCount,m=n.likes,b=Object(o.useContext)(O).user;return Object(c.jsxs)("div",{className:"postcard",children:[Object(c.jsxs)("div",{className:"postcard-body",children:[Object(c.jsx)("p",{className:"postcard-header",children:r}),Object(c.jsx)("p",{className:"postcard-createdAt",children:v()(s).fromNow()}),Object(c.jsx)("p",{className:"postcard-content",children:l})]}),Object(c.jsxs)("div",{className:"postcard-btns",children:[Object(c.jsx)(y,{user:b,post:{id:t,likes:m,likeCount:d}}),e.comment?Object(c.jsx)(i.b,{to:"posts/".concat(t),children:Object(c.jsxs)("button",{className:"postcard-btn",children:[Object(c.jsx)("i",{className:"far fa-comments postcard-btn-icon"}),Object(c.jsx)("p",{className:"postcard-btn-num",children:u})]})}):Object(c.jsxs)("button",{className:"postcard-btn",children:[Object(c.jsx)("i",{className:"far fa-comments postcard-btn-icon"}),Object(c.jsx)("p",{className:"postcard-btn-num",children:u})]}),b&&(b.id===a||"5fe59a8218d0de5001587e43"===b.id)&&Object(c.jsx)(q,{postId:t,open_close_modal:e.open_close_modal,deletePostCallback:e.deletePostCallback})]})]})},_=t(88),T=t(54),M=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},t=Object(o.useState)(n),a=Object(d.a)(t,2),r=a[0],s=a[1],c=function(e){s(Object(u.a)(Object(u.a)({},r),{},Object(T.a)({},e.target.name,e.target.value)))},i=function(n){n.preventDefault(),e()};return{onChange:c,onSubmit:i,values:r}};function D(){var e=Object(g.a)(["\n    mutation createPost(\n        $body: String!\n    ) {\n        createPost(\n            body: $body\n        ) {\n            id\n            userId\n            username\n            createdAt\n            body\n            likeCount\n            commentCount\n            comments {\n                id\n                userId\n                username\n                createdAt\n                body\n            }\n            likes {\n                id\n                userId\n                username\n                createdAt\n            }\n        }\n    }\n"]);return D=function(){return e},e}var Q=Object(h.gql)(D()),U=function(){var e=M((function(){o()}),{body:""}),n=e.values,t=e.onChange,a=e.onSubmit,r=Object(h.useMutation)(Q,{variables:n,update:function(e,t){var a=e.readQuery({query:w}),r=Object(u.a)({},a);r.getPosts=[t.data.createPost].concat(Object(_.a)(r.getPosts)),e.writeQuery({query:w,data:r}),n.body=""},onError:function(e){console.log(e)}}),s=Object(d.a)(r,2),o=s[0],i=s[1].error;return Object(c.jsxs)("form",{className:"form-02",onSubmit:function(e){return a(e)},children:[Object(c.jsx)("h2",{className:"form-02-title",children:"Create a post:"}),Object(c.jsxs)("div",{className:"form-02-grp",children:[Object(c.jsx)("input",{id:"form-02-input",className:i?"form-02-input form-02-input-error":"form-02-input",placeholder:"Hi World!",name:"body",onChange:function(e){return t(e)},value:n.body}),i&&Object(c.jsx)("ul",{className:"form-02-error",children:Object(c.jsx)("li",{className:"form-02-error-p",children:i.graphQLErrors[0].message})}),Object(c.jsx)("button",{className:"form-02-submit",children:"Submit"})]})]})},H=function(){Object(o.useEffect)((function(){N().underline()}));var e=Object(o.useContext)(O).user,n=Object(h.useQuery)(w),t=n.loading,a=n.data;return Object(c.jsxs)("div",{className:"container",children:[Object(c.jsx)("h1",{className:"containerH1",children:"Recent Posts"}),Object(c.jsxs)("div",{className:"home",children:[e&&Object(c.jsx)("div",{className:"home-comment",children:Object(c.jsx)(U,{})}),t?Object(c.jsx)("h1",{children:"Loading posts..."}):a.getPosts&&a.getPosts.map((function(e){return Object(c.jsx)(E,{post:e,comment:!0},e.id)}))]})]})},B=function(e){return Object(c.jsxs)("div",{className:e.error?"form-01-grp form-01-grp-error":"form-01-grp",children:[Object(c.jsx)("label",{className:"form-01-grp-label",children:e.label}),Object(c.jsx)("input",{id:e.id,className:"form-01-grp-input",type:e.type,value:e.value,placeholder:e.placeholder,name:e.name,onChange:function(n){return e.handle_change(n)}})]})};function F(){var e=Object(g.a)(["\n    mutation register (\n        $username: String!\n        $email: String!\n        $password: String!\n        $confirmPassword: String!\n    ) {\n        register(\n            registerInput: {\n                username: $username, \n                email: $email, \n                password: $password, \n                confirmPassword: $confirmPassword\n            }\n        ){\n            id\n            username\n            email\n            createdAt\n            token\n        }\n    }\n"]);return F=function(){return e},e}var G=Object(h.gql)(F()),R=function(e){var n=Object(o.useContext)(O),t=Object(o.useState)({}),a=Object(d.a)(t,2),r=a[0],s=a[1],i=M((function(){p()}),{username:"",email:"",password:"",confirmPassword:""}),l=i.onChange,u=i.onSubmit,m=i.values,b=Object(h.useMutation)(G,{update:function(t,a){var r=a.data.register;n.login(r),e.history.push("/")},onError:function(e){s(e.graphQLErrors[0].extensions.exception.errors)},variables:m}),j=Object(d.a)(b,2),p=j[0],f=j[1].loading;return Object(c.jsxs)("div",{className:"container",children:[Object(c.jsx)("h1",{className:"containerH1",children:"Register"}),Object(c.jsxs)("form",{className:f?"form-01-loading":"form-01",onSubmit:function(e){return u(e)},noValidate:!0,children:[Object(c.jsx)("div",{className:"form-01-loading-icon-con",children:Object(c.jsx)("i",{className:"form-01-loading-icon fas fa-spinner"})}),Object(c.jsx)(B,{label:"Username",placeholder:"Username",type:"text",name:"username",value:m.username,error:!!r.username,handle_change:l}),Object(c.jsx)(B,{label:"Email",placeholder:"Email",type:"email",name:"email",value:m.email,error:!!r.email,handle_change:l}),Object(c.jsx)(B,{label:"Password",placeholder:"Password",type:"password",name:"password",value:m.password,error:!!r.password,handle_change:l}),Object(c.jsx)(B,{label:"Confirm Password",placeholder:"Confirm Password",type:"password",name:"confirmPassword",value:m.confirmPassword,error:!!r.confirmPassword,handle_change:l}),Object(c.jsx)("button",{className:"form-01-submit-btn",children:"SUBMIT"}),Object.keys(r).length>0&&Object(c.jsx)("div",{className:"form-01-error",children:Object(c.jsx)("ul",{className:"form-01-error-list",children:Object.values(r).map((function(e){return Object(c.jsx)("li",{className:"form-01-error-list-li",children:e},e)}))})})]})]})};function J(){var e=Object(g.a)(["\n    mutation login (\n        $username: String!\n        $password: String!\n    ) {\n        login(\n                username: $username,\n                password: $password\n        ){\n            id\n            username\n            email\n            createdAt\n            token\n        }\n    }\n"]);return J=function(){return e},e}var V=Object(h.gql)(J()),z=function(e){Object(o.useEffect)((function(){N().underline()}));var n=Object(o.useContext)(O),t=Object(o.useState)({}),a=Object(d.a)(t,2),r=a[0],s=a[1],i=M((function(){p()}),{username:"",password:""}),l=i.onChange,u=i.onSubmit,m=i.values,b=Object(h.useMutation)(V,{update:function(t,a){var r=a.data.login;n.login(r),e.history.push("/"),N().underline()},onError:function(e){s(e.graphQLErrors[0].extensions.exception.errors)},variables:m}),j=Object(d.a)(b,2),p=j[0],f=j[1].loading;return Object(c.jsxs)("div",{className:"container",children:[Object(c.jsx)("h1",{className:"containerH1",children:"Login"}),Object(c.jsxs)("form",{className:f?"form-01-loading":"form-01",onSubmit:function(e){return u(e)},noValidate:!0,children:[Object(c.jsx)("div",{className:"form-01-loading-icon-con",children:Object(c.jsx)("i",{className:"form-01-loading-icon fas fa-spinner"})}),Object(c.jsx)(B,{label:"Username",placeholder:"Username",type:"text",name:"username",value:m.username,error:!!r.username,handle_change:l}),Object(c.jsx)(B,{label:"Password",placeholder:"Password",type:"password",name:"password",value:m.password,error:!!r.password,handle_change:l}),Object(c.jsx)("button",{className:"form-01-submit-btn",children:"SUBMIT"}),Object.keys(r).length>0&&Object(c.jsx)("div",{className:"form-01-error",children:Object(c.jsx)("ul",{className:"form-01-error-list",children:Object.values(r).map((function(e){return Object(c.jsx)("li",{className:"form-01-error-list-li",children:e},e)}))})})]})]})},W=function(){var e=Object(o.useContext)(O),n=e.user,t=e.logout,a=Object(o.useState)("home"),r=Object(d.a)(a,2),s=r[0],l=r[1],u=window.location.pathname;Object(o.useEffect)((function(){var e="/"===u?"home":u.substr(1).toLowerCase();l(e),N().underline()}),[u,s,l]);var m=function(e){l(e)};return n?Object(c.jsxs)("div",{id:"navbar",className:"Navbar",children:[Object(c.jsx)(i.b,{id:"navbar-home",className:"navbar-link",to:"/",onClick:function(){return m("home")},children:Object(c.jsx)("p",{className:"navbarP",children:n.username})}),Object(c.jsx)(i.b,{id:"navbar-login",className:"navbar-link",to:"/",onClick:function(){return m("home"),void t()},children:Object(c.jsx)("p",{className:"navbarP",children:"Logout"})})]}):Object(c.jsxs)("div",{id:"navbar",className:"Navbar",children:[Object(c.jsx)(i.b,{id:"navbar-home",className:"navbar-link",to:"/",onClick:function(){return m("home")},children:Object(c.jsx)("p",{className:"navbarP",children:"Home"})}),Object(c.jsx)(i.b,{id:"navbar-login",className:"navbar-link",to:"/login",onClick:function(){return m("login")},children:Object(c.jsx)("p",{className:"navbarP",children:"Login"})}),Object(c.jsx)(i.b,{id:"navbar-register",className:"navbar-link",to:"/register",onClick:function(){return m("register")},children:Object(c.jsx)("p",{className:"navbarP",children:"Register"})})]})},K=t(84),X=function(e){var n=e.component,t=Object(K.a)(e,["component"]),a=Object(o.useContext)(O).user;return Object(c.jsx)(l.b,Object(u.a)(Object(u.a)({},t),{},{render:function(e){return a?Object(c.jsx)(l.a,{to:"/"}):Object(c.jsx)(n,Object(u.a)({},e))}}))},Y=function(e){var n=e.postId,t=e.comment,a=t.id,r=t.userId,s=t.username,i=t.createdAt,l=t.body,d=Object(o.useContext)(O).user;return Object(c.jsxs)("div",{className:"postcard postcard-comment",children:[Object(c.jsxs)("div",{className:"postcard-body",children:[Object(c.jsx)("p",{className:"postcard-header",children:s}),Object(c.jsx)("p",{className:"postcard-createdAt",children:v()(i).fromNow()}),Object(c.jsx)("p",{className:"postcard-content",children:l})]}),Object(c.jsx)("div",{className:"postcard-btns postcard-comment-btns",children:d&&(d.id===r||"5fe59a8218d0de5001587e43"===d.id)&&Object(c.jsx)(q,{postId:n,commentId:a,open_close_modal:e.open_close_modal,isComment:!0})})]})};function Z(){var e=Object(g.a)(["\n    query($postId: ID!) {\n        getPost(postId: $postId) {\n            id userId username createdAt body likeCount commentCount\n            likes {\n                userId\n            }\n            comments {\n                id\n                userId\n                username\n                createdAt\n                body\n            }\n        }\n    }\n\n"]);return Z=function(){return e},e}function ee(){var e=Object(g.a)(["\n    mutation($postId: ID!, $body: String!) {\n        createComment(postId: $postId, body: $body) {\n            id\n            comments {\n                id userId username createdAt body\n            }\n            commentCount\n        }\n    }\n"]);return ee=function(){return e},e}var ne=Object(h.gql)(ee()),te=Object(h.gql)(Z()),ae=function(e){var n,t=Object(o.useContext)(O).user,a=Object(o.useState)(""),r=Object(d.a)(a,2),s=r[0],i=r[1],l=e.match.params.postId,u=Object(h.useQuery)(te,{variables:{postId:l}}),m=u.data,b=u.loading,j=Object(h.useMutation)(ne,{update:function(){i("")},variables:{postId:l,body:s}}),p=Object(d.a)(j,1)[0];function f(){e.history.push("/")}if(m){var x=m.getPost;n=Object(c.jsx)("div",{className:"container",children:Object(c.jsxs)("div",{className:"singlePost",children:[b?Object(c.jsx)("h1",{children:"Loading..."}):Object(c.jsx)(E,{post:x,comment:!1,deletePostCallback:f},x.id),t&&Object(c.jsxs)("div",{className:"singlePost-comment",children:[Object(c.jsx)("p",{className:"singlePost-comment-title",children:"Post a comment"}),Object(c.jsxs)("form",{className:"singlePost-comment-form",onSubmit:function(e){return e.preventDefault()},children:[Object(c.jsx)("input",{className:"singlePost-comment-input",type:"text",placeholder:"Comment...",name:"comment",value:s,autoComplete:"off",onChange:function(e){return i(e.target.value)}}),Object(c.jsx)("button",{className:"singlePost-comment-submit",disabled:""===s.trim(),onClick:function(){return p()},children:"Submit"})]})]}),b?Object(c.jsx)("h1",{children:"Loading..."}):x.comments.map((function(e){return Object(c.jsx)(Y,{postId:x.id,comment:e,deletePostCallback:f},e.id)}))]})})}else n=Object(c.jsx)("p",{children:"Loading post..."});return n},re=function(){return Object(c.jsx)(f,{children:Object(c.jsxs)(i.a,{children:[Object(c.jsx)(W,{},"navbar"),Object(c.jsx)(l.b,{exact:!0,path:"/",component:H}),Object(c.jsx)(X,{exact:!0,path:"/login",component:z}),Object(c.jsx)(X,{exact:!0,path:"/register",component:R}),Object(c.jsx)(l.b,{exact:!0,path:"/posts/:postId",component:ae})]})})},se=t(85),ce=t(89),oe=Object(h.createHttpLink)({uri:"https://g2social-backend.herokuapp.com"}),ie=Object(ce.a)((function(){var e=localStorage.getItem("jwtToken");return{headers:{Authorization:e?"Bearer ".concat(e):""}}})),le=new se.a({link:ie.concat(oe),cache:new h.InMemoryCache}),de=Object(c.jsx)(h.ApolloProvider,{client:le,children:Object(c.jsx)(re,{})});r.a.render(de,document.getElementById("root")),s()},94:function(e,n,t){},96:function(e,n,t){}},[[109,1,2]]]);
//# sourceMappingURL=main.9794ba91.chunk.js.map